<div class="admin-container">
  <div class="header">
    <button class="btn-back" (click)="volverAlDashboard()">â† Volver</button>
    <h1>GestiÃ³n de Carreras</h1>
    <button class="btn-nuevo" (click)="mostrarNuevoFormulario()" *ngIf="!mostrarFormulario">
      + Nueva Carrera
    </button>
  </div>

  <!-- Mensajes -->
  <div *ngIf="mensaje" class="mensaje-exito">{{ mensaje }}</div>
  <div *ngIf="error" class="mensaje-error">{{ error }}</div>

  <!-- Formulario -->
  <div *ngIf="mostrarFormulario" class="form-card">
    <h3>{{ modoEdicion ? 'Editar Carrera' : 'Nueva Carrera' }}</h3>
    <form (ngSubmit)="guardarCarrera()" #carreraForm="ngForm">
      <div class="form-group">
        <label for="codigo">CÃ³digo *</label>
        <input 
          type="text" 
          id="codigo" 
          name="codigo"
          [(ngModel)]="nuevaCarrera.codigo"
          (focus)="limpiarMensajes()"
          required
          placeholder="Ej: ING-SIS"
          maxlength="10"
        >
      </div>

      <div class="form-group">
        <label for="nombre">Nombre *</label>
        <input 
          type="text" 
          id="nombre" 
          name="nombre"
          [(ngModel)]="nuevaCarrera.nombre"
          (focus)="limpiarMensajes()"
          required
          placeholder="Ej: IngenierÃ­a de Sistemas"
          maxlength="100"
        >
      </div>

      <div class="form-group">
        <label for="descripcion">DescripciÃ³n *</label>
        <textarea 
          id="descripcion" 
          name="descripcion"
          [(ngModel)]="nuevaCarrera.descripcion"
          (focus)="limpiarMensajes()"
          required
          rows="4"
          placeholder="Describe la carrera, su enfoque y Ã¡reas de estudio..."
          maxlength="500"
        ></textarea>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-guardar" [disabled]="!carreraForm.form.valid || guardando">
          {{ guardando ? 'Guardando...' : modoEdicion ? 'ğŸ’¾ Actualizar' : 'ğŸ’¾ Crear' }}
        </button>
        <button type="button" class="btn-cancelar" (click)="cancelarFormulario()">
          âŒ Cancelar
        </button>
      </div>
    </form>
  </div>

  <!-- Tabla -->
  <div class="tabla-card">
    <h3>Lista de Carreras ({{ carreras.length }})</h3>
    
    <div *ngIf="cargando" class="loading">Cargando carreras...</div>

    <div *ngIf="!cargando && carreras.length === 0" class="no-data">
      <p>ğŸ“ No hay carreras registradas</p>
      <p>Haz clic en "Nueva Carrera" para comenzar</p>
    </div>

    <table *ngIf="!cargando && carreras.length > 0">
      <thead>
        <tr>
          <th>CÃ³digo</th>
          <th>Nombre</th>
          <th>DescripciÃ³n</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let carrera of carreras">
          <td><span class="badge-codigo">{{ carrera.codigo }}</span></td>
          <td class="nombre">{{ carrera.nombre }}</td>
          <td class="descripcion">{{ carrera.descripcion }}</td>
          <td class="acciones">
            <button class="btn-editar" (click)="editarCarrera(carrera)">
              âœï¸ Editar
            </button>
            <button class="btn-eliminar" (click)="eliminarCarrera(carrera.id!, carrera.nombre)">
              ğŸ—‘ï¸ Eliminar
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="info-box">
    <p>ğŸ’¡ <strong>Nota:</strong> El cÃ³digo debe ser Ãºnico (ej: ING-SIS, MED-GEN).</p>
    <p>âš ï¸ Al eliminar una carrera se eliminarÃ¡n tambiÃ©n todos sus pesos asociados.</p>
  </div>
</div>
