<div class="usuarios-container">
  
  <div class="usuarios-header">
    <div class="header-info">
      <h2>GestiÃ³n de Usuarios</h2>
      <p>Administra los usuarios del sistema</p>
    </div>
    <div class="header-buttons">
      <button class="btn-dashboard" (click)="irAlDashboard()">Dashboard</button>
      <button class="btn-nuevo" (click)="nuevoUsuario()">+ Nuevo Usuario</button>
      <button class="btn-logout" (click)="cerrarSesion()">Cerrar SesiÃ³n</button>
    </div>
  </div>

  <div *ngIf="mensajeExito" class="mensaje-exito">
    âœ… {{ mensajeExito }}
    <button (click)="limpiarMensajes()" class="btn-cerrar">Ã—</button>
  </div>

  <div *ngIf="mensajeError" class="mensaje-error">
    âŒ {{ mensajeError }}
    <button (click)="limpiarMensajes()" class="btn-cerrar">Ã—</button>
  </div>

  <div *ngIf="mostrarFormulario" class="formulario-usuario">
    <h3>{{ modoEdicion ? 'âœï¸ Editar Usuario' : 'â• Crear Nuevo Usuario' }}</h3>
    
    <form (ngSubmit)="guardarUsuario()">
      <div class="form-row">
        <div class="form-group">
          <label for="username">Usuario:</label>
          <input type="text" id="username" name="username" 
                 [(ngModel)]="usuarioActual.username" 
                 placeholder="Nombre de usuario" required>
        </div>
        
        <div class="form-group">
          <label for="email">Email:</label>
          <input type="email" id="email" name="email" 
                 [(ngModel)]="usuarioActual.email" 
                 placeholder="correo@ejemplo.com" required>
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="nombreCompleto">Nombre Completo:</label>
          <input type="text" id="nombreCompleto" name="nombreCompleto" 
                 [(ngModel)]="usuarioActual.nombreCompleto" 
                 placeholder="Nombre completo">
        </div>
        
        <div class="form-group">
          <label for="password">ContraseÃ±a:</label>
          <input type="password" id="password" name="password" 
                 [(ngModel)]="usuarioActual.password" 
                 [placeholder]="modoEdicion ? 'Dejar vacÃ­o para mantener actual' : 'ContraseÃ±a'">
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="role">Rol:</label>
          <select id="role" name="role" [(ngModel)]="usuarioActual.role">
            <option value="USER">Usuario</option>
            <option value="ADMIN">Administrador</option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="enabled">Estado:</label>
          <select id="enabled" name="enabled" [(ngModel)]="usuarioActual.enabled">
            <option [value]="true">Activo</option>
            <option [value]="false">Inactivo</option>
          </select>
        </div>
      </div>

      <div class="form-buttons">
        <button type="submit" class="btn-guardar" [disabled]="loading">
          {{ loading ? 'â³ Guardando...' : (modoEdicion ? 'ğŸ’¾ Actualizar' : 'â• Crear') }}
        </button>
        <button type="button" class="btn-cancelar" (click)="cancelarFormulario()">
          âŒ Cancelar
        </button>
      </div>
    </form>
  </div>

  <div *ngIf="loading && !mostrarFormulario" class="loading">
    <p>â³ Cargando usuarios...</p>
  </div>

  <div *ngIf="!loading" class="usuarios-lista">
    <div class="usuario-item" *ngFor="let user of users">
      <div class="usuario-info">
        <h3>ğŸ‘¤ {{ user.username }}</h3>
        <p>ğŸ“§ {{ user.email }}</p>
        <p>ğŸ‘¨â€ğŸ’¼ {{ user.nombreCompleto || 'Sin nombre' }}</p>
        <span class="rol" [class.admin]="user.role === 'ADMIN'">{{ user.role }}</span>
        <span class="estado" [class.inactivo]="!user.enabled">
          {{ user.enabled ? 'ğŸŸ¢ Activo' : 'ğŸ”´ Inactivo' }}
        </span>
      </div>
      
      <div class="usuario-acciones">
        <button class="btn-editar" (click)="editarUsuario(user)">âœï¸ Editar</button>
        <button class="btn-eliminar" (click)="eliminarUsuario(user)">ğŸ—‘ï¸ Eliminar</button>
      </div>
    </div>
    
    <div *ngIf="users.length === 0" class="no-usuarios">
      <p>ğŸ“­ No hay usuarios registrados</p>
      <button class="btn-crear-primero" (click)="nuevoUsuario()">â• Crear el primer usuario</button>
    </div>
  </div>

</div>
